<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="fqpmQwGNtZ1kJ8UAsQMb7RD2N7DcYRDlyGbAJsnZuGM"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Discriminative Classification | Roy Friedman</title> <meta name="author" content="Roy Friedman"> <meta name="description" content="In this post, we start talking about classification, finally moving on from the world of linear regression. It turns out that exchanging the continuous outputs for discrete ones nullifies all of the maths we saw in the world of linear regression."> <meta name="keywords" content="academic-website, roy-friedman, machine-learning, ML, bayesian, PhD"> <meta name="google-site-verification" content="EUCyoY6MaSyn4ZvM9TfAuzzeleW7dR0PHS4_UCtyZ4I"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://friedmanroy.github.io/BML/11_discriminative_classification/"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "Discriminative Classification",
      "description": "In this post, we start talking about classification, finally moving on from the world of linear regression. It turns out that exchanging the continuous outputs for discrete ones nullifies all of the maths we saw in the world of linear regression.",
      "published": "March 1, 2024",
      "authors": [
        {
          "author": "Roy Friedman",
          "authorURL": "",
          "affiliations": [
            {
              "name": "Hebrew University",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Roy </span>Friedman</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/BML/">Bayesian Machine Learning</a> </li> <li class="nav-item "> <a class="nav-link" href="/_pages/cv/">CV</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Discriminative Classification</h1> <p>In this post, we start talking about classification, finally moving on from the world of linear regression. It turns out that exchanging the continuous outputs for discrete ones nullifies all of the maths we saw in the world of linear regression.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#discriminative-classification">Discriminative Classification</a></div> <div><a href="#classification-as-regression-or-mse-classification">Classification as Regression (or MSE Classification)</a></div> <div><a href="#map-estimation">MAP Estimation</a></div> <div><a href="#discussion">Discussion</a></div> </nav> </d-contents> <p><span style="float:left"><a href="https://friedmanroy.github.io/BML/10_gaussian_process/">← Gaussian processes</a></span><span style="float:right"><a href="https://friedmanroy.github.io/BML/12_generative_classification/">Generative classification →</a></span> <br> <br></p> <p>So far, we have only considered regression in this series of posts. However, regression is not the only task of interest in machine learning and we will now turn our attention towards <em>classification</em>. Very broadly, classification is quite similar to regression - in both we get a dataset comprised of pairs $\mathcal{D}=\{ \left(x_{i},y_{i}\right)\}_{i=1}^{N}$, and in both we attempt to predict the value of $y_{i}$ given $x_{i}$. However, while in (normal) regression $y_{i}\in\mathbb{R}$ is a scalar, in classification the $y_{i}$s are categorical, i.e. $y_{i}\in\{ 1,\cdots,C\}$. This small change ends up affecting and ruining many of the mathematical operations we had up until now, in surprising ways.</p> <p>Broadly speaking, there are two types of classification: discriminative and generative. We will begin by discussing discriminative classification in this post, wherein we will see that explicitly defining the posterior is basically impossible. We will then move on to generative classification in the next post, which is harder but more forgiving to the Bayesian approach.</p> <h1 id="discriminative-classification">Discriminative Classification</h1> <p>In <em>discriminative classification</em>, we attempt to model the distribution of the class label conditional on the input:</p> \[\begin{equation} p\left(y=c\vert x,\theta\right) \end{equation}\] <p>The most common approach to do this is to learn some function $f_{\theta}\left(x;y\right)$ that is supposed to encode the probability that sample $x$ belongs to class $y$. Of course, the probabilities are discrete, and thus must be smaller than 1 while still summing up to 1. To ensure this, the modeled probability is usually defined according to:</p> \[\begin{equation} p\left(y=c\vert x,\theta\right)=\frac{e^{f_{\theta}\left(x;c\right)}}{\sum_{y}e^{f_{\theta}\left(x;y\right)}} \end{equation}\] <p>The exponent ensures that the probabilities are positive, while the sum over exponents ensures that the all probabilities sum to one - this function is sometimes called the <em>softmax</em> function.</p> <p>In binary classification (when there are only two classes), we can slightly simplify the above. Assuming that $y\in\left{ 0,1\right}$, the probability for a class given a sample is modeled as:</p> \[\begin{equation} p\left(y=1\vert x,\theta\right)=\sigma\left(f_{\theta}\left(x\right)\right)\stackrel{\Delta}{=}\frac{1}{1+e^{-f_{\theta}\left(x\right)}}=\frac{e^{f_{\theta}\left(x\right)}}{1+e^{f_{\theta}\left(x\right)}} \end{equation}\] <p>where $\sigma\left(\cdot\right)$ is called the <em>logistic function</em>. The logistic function is like a simplified version of the softmax operator we saw above, and has the following useful property:</p> \[\begin{align} p\left(y=0\vert x,\theta\right) &amp; =1-p\left(y=1\vert x,\theta\right)\\ &amp; =1-\sigma\left(f_{\theta}\left(x\right)\right)\\ &amp; =1-\frac{1}{1+e^{-f_{\theta}\left(x\right)}}\\ &amp; =\frac{1+e^{-f_{\theta}\left(x\right)}-1}{1+e^{-f_{\theta}\left(x\right)}}\\ &amp; =\frac{e^{-f_{\theta}\left(x\right)}}{1+e^{-f_{\theta}\left(x\right)}}=\sigma\left(-f_{\theta}\left(x\right)\right) \end{align}\] <p>In the particular case when probabilities are modeled as a linear function of the parameters, i.e. $f_{\theta}\left(x\right)=h^{T}\left(x\right)\theta$, then the above is called <em>logistic regression</em>.</p> <h2 id="associated-likelihood">Associated Likelihood</h2> <p>Notice that above class probabilities describe a sample-specific likelihood. Let’s consider the binary case and assume we observe some data $\mathcal{D}=\{\left(x_{i},y_{i}\right)\}_{i=1}^{N}$ where $y_{i}\in\{ 0,1\}$, then we can write the full likelihood as:</p> \[\begin{align} p\left(\mathcal{D}\vert\theta\right) &amp; =\prod_{i=1}^{N}p\left(y_{i}\vert x_{i},\theta\right)\\ &amp; =\prod_{i=1}^{N}p\left(1\vert x_{i},\theta\right)^{y_{i}}p\left(0\vert x_{i},\theta\right)^{1-y_{i}}\\ &amp; =\prod_{i=1}^{N}\sigma\left(f_{\theta}\left(x\right)\right)^{y_{i}}\cdot\left(1-\sigma\left(f_{\theta}\left(x\right)\right)\right)^{1-y_{i}} \end{align}\] <p>So the log-likelihood takes the following form:</p> \[\begin{equation} \log p\left(\mathcal{D}|\theta\right)=\sum_{i=1}^{N}\left[y_{i}\log\sigma\left(f_{\theta}\left(x\right)\right)+\left(1-y_{i}\right)\log\left(1-\sigma\left(f_{\theta}\left(x\right)\right)\right)\right] \end{equation}\] <p>The negative of this term is often called the <em>binary cross-entropy</em> (BCE) loss<d-footnote>This is because the loss is exactly the definition of cross-entropy, if you consider $y_i$ as the true probability for the class label and $\sigma(f_\theta(x))$ as the predicted</d-footnote>.</p> <p><br></p> <h2 id="the-problem-of-non-conjugacy">The Problem of Non-Conjugacy</h2> <p>Notice that this log-likelihood is very un-Gaussian in the parameters $\theta$, unlike every likelihood we have seen so far - even when the function $f_{\theta}$ is linear in the parameters! This is unfortunate as it means that even if we choose a Gaussian prior over the parameters $\theta$, finding the posterior will prove difficult. We might be tempted to try and find a new class of distributions $\mathcal{Q}$ (instead of Gaussians) that might be conjugate to the classification likelihood, i.e.:</p> \[\begin{equation} p\left(\theta\right)\in\mathcal{Q}\Leftrightarrow p\left(\theta\right)p\left(\mathcal{D}|\theta\right)\propto p\left(\theta|\mathcal{D}\right)\in\mathcal{Q} \end{equation}\] <p>However, it turns out that there is no such class of distributions and that there is no closed form solution for the posterior. So it will be quite hard to use the posterior and we will often have to resort to approximations of it in order to make predictions. We will discuss some of these approximations later on in the course in the form of <em>Markov Chain Monte Carlo</em> (MCMC) techniques, although this is still just the tip of the iceberg of approximation techniques.</p> <p><br></p> <h1 id="classification-as-regression-or-mse-classification">Classification as Regression (or MSE Classification)</h1> <p>As we saw above, the reason the posterior becomes so hard to find is because the likelihood function in classification is not Gaussian. However, we can also use the Gaussian likelihood in order to learn our classifier. In such a case, we will define (as usual):</p> \[\begin{equation} \log p\left(\mathcal{D}|\theta\right)=\sum_{i}\log\mathcal{N}\left(y_{i}|\;f_{\theta}\left(x_{i}\right),\sigma^{2}\right) \end{equation}\] <p>where $\sigma^{2}$ is somehow appropriately chosen to reflect our beliefs about how often the label $y_{i}$ is flipped. Using this likelihood is either called <em>classification as regression</em> or <em>MSE classification</em>, since the MSE loss is used in order to train the classifier. In these cases, it is typical to define $y_{i}\in\{ -1,1\}$.</p> <p>This is kind of an “inappropriate likelihood” in the sense that it doesn’t truly reflect the way the data was created, but it turns out that this likelihood is also very effective for classification. Given a new point $x^{*}$, our classifier will be:</p> \[\begin{equation} \hat{y}\left(x^{*}\right)=\begin{cases} 1 &amp; f_{\theta}\left(x^{*}\right)\ge0\\ -1 &amp; f_{\theta}\left(x^{*}\right)&lt;0 \end{cases} \end{equation}\] <p>While this method doesn’t properly describe our assumptions of the data, it does have a big advantage - it allows us to accurately describe our uncertainty in the prediction. Using the classification rule above, define $p\left(\hat{y}\vert x^{*},\theta\right)$ as the probability of the classification $\hat{y}$ under the posterior. Then, we can find the probability for each class under our model:</p> \[\begin{align} p\left(\hat{y}=-1|x^{*},\theta\right) &amp; =\intop_{-\infty}^{0}p\left(f_{\theta}\left(x^{*}\right)\right)df_{\theta}\left(x^{*}\right)\\ \Leftrightarrow p\left(\hat{y}=1|x^{*},\theta\right) &amp; =1-p\left(y^{*}=-1|x^{*},\theta\right) \end{align}\] <p><br></p> <h1 id="map-estimation">MAP Estimation</h1> <p>Note that while finding the posterior seems hard, the BCE is frequently optimized using gradient based methods. Because the function $f_{\theta}\left(x\right)$ can usually be efficiently calculated, this makes discriminative classification a very attractive method, since classifying a new point $x_{n}$ involves only one (efficient) calculation.</p> <p>As we saw before, when talking about linear regression, we can actually modify the loss used to train the classifier in order to get a MAP estimate. This is done by defining and optimizing the regularized BCE:</p> \[\begin{equation} \log p\left(\theta|\mathcal{D}\right)=\sum_{i=1}^{N}\left[y_{i}\log\sigma\left(f_{\theta}\left(x\right)\right)+\left(1-y_{i}\right)\log\left(1-\sigma\left(f_{\theta}\left(x\right)\right)\right)\right]+\log p\left(\theta\right)+\text{const} \end{equation}\] <p><br></p> <h1 id="discussion">Discussion</h1> <p>This problem of intractability that we have encountered above is surprising, because it doesn’t <em>feel</em> like the underlying problem changed much. But this actually happens in many places; for instance, convex optimization is straightforward, but trying to move to integer optimization (which doesn’t seem much different) suddenly makes the problem NP-hard.</p> <p>Because of this, Bayesian discriminative classification usually approximate the posterior or outputs samples from the posterior for classification. Later on, we will talk a bit more about sampling for estimation when the posterior is intractable.</p> <p>In the next post, we will take a look at <em>generative classification</em>, which is somewhat more forgiving to the Bayesian framework but also requires stricter assumptions.</p> <hr> <p><span style="float:left"><a href="https://friedmanroy.github.io/BML/10_gaussian_process/">← Gaussian processes</a></span><span style="float:right"><a href="https://friedmanroy.github.io/BML/12_generative_classification/">Generative classification →</a></span></p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Roy Friedman. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener noopener noreferrer" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener noopener noreferrer">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-1B05NVC2PJ"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-1B05NVC2PJ");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>