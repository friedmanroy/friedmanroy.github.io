<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="fqpmQwGNtZ1kJ8UAsQMb7RD2N7DcYRDlyGbAJsnZuGM"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>The Benefits of Sampling | Roy Friedman</title> <meta name="author" content="Roy Friedman"> <meta name="description" content="When the posterior is complex, it is typically quite hard to get a sense for the full distribution. As such, it is common to represent the full distribution using samples from the posterior. In this post we will look at the benefits of doing so."> <meta name="keywords" content="academic-website, roy-friedman, machine-learning, ML, bayesian, PhD"> <meta name="google-site-verification" content="EUCyoY6MaSyn4ZvM9TfAuzzeleW7dR0PHS4_UCtyZ4I"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://friedmanroy.github.io/BML/14_sampling/"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "The Benefits of Sampling",
      "description": "When the posterior is complex, it is typically quite hard to get a sense for the full distribution. As such, it is common to represent the full distribution using samples from the posterior. In this post we will look at the benefits of doing so.",
      "published": "October 20, 2025",
      "authors": [
        {
          "author": "Roy Friedman",
          "authorURL": "",
          "affiliations": [
            {
              "name": "Hebrew University",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Roy </span>Friedman</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/BML/">Bayesian Machine Learning</a> </li> <li class="nav-item "> <a class="nav-link" href="/_pages/cv/">CV</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>The Benefits of Sampling</h1> <p>When the posterior is complex, it is typically quite hard to get a sense for the full distribution. As such, it is common to represent the full distribution using samples from the posterior. In this post we will look at the benefits of doing so.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#the-problem-with-point-estimates">The Problem with Point Estimates</a></div> <div><a href="#concrete-example">Concrete Example</a></div> <div><a href="#discussion">Discussion</a></div> </nav> </d-contents> <p><span style="float:left"><a href="https://friedmanroy.github.io/BML/13_gmms/">← GMMs and EM</a></span><span style="float:right"><a href=""> →</a></span> <br> <br></p> <p>Throughout most of the previous posts, the focus was Gaussian priors and posteriors. The simplicity of the Gaussian distribution allowed us to directly characterize the full posterior distribution fairly easily - all we needed to describe the whole distribution was the mean (MMSE/MAP) and the covariance of the posterior. In those cases, trying to find the mean or maximum of the posterior makes a lot of sense, as it portrays most of the important aspects of the distribution. However, for more complex distributions, using a single estimate of the parameters (such as the MAP or MMSE) in order to describe the full posterior might not be the best approach.</p> <p>In this post we will look at an alternative to point estimates (such as the MAP or MMSE), in the form of <em>sampling parameters from the posterior</em>.</p> <hr> <h1 id="the-problem-with-point-estimates">The Problem with Point Estimates</h1> <p>First, I’d like to motivate why point estimates might be suboptimal in some cases. We’ll start with an abstract example and then look at more concrete scenarios. Consider the following sketch of a hypothetical posterior distribution:</p> <div class="fake-img l-page"> <p align="center"> <img src="https://friedmanroy.github.io/assets/bml_figs/rec_14/bad_avg.png" alt="Point estimates under a GMM posterior" style="display: inline-block; margin: 0 auto; "> </p> </div> <div class="caption"> Figure 1: A sketch of a GMM posterior distribution. The dashed, blue line depicts the position of the mean of the distribution (i.e. the MMSE estimate) whereas the dashed, red line is the position of the maximum (the MAP estimate). </div> <p>In this, admittedly quite synthetic, scenario both the MAP and MMSE estimates are a rather poor indication of the posterior as a whole. The MMSE falls in a very unlikely region of space, just between both modes. The MAP is better, since it at least has a higher density, but is also located on a rather narrow region of the posterior, which is still a bad description of the overall distribution.</p> <p>In fact, any single parameter choice on this distribution will misrepresent the distribution as a whole!</p> <p>What do I mean by that? The distribution has 3 different modes - three separate regions of high probability. If we arbitrarily choose any one of them as the representative for the whole distribution, then we are missing the information about the other 2 modes. Moreover, in cases like this, even choosing the mode according to the MAP estimate <em>describes the least likely mode out of the 3</em>. This is quite different to the Gaussian cases we explored previously, where the mean of the posterior really did give us most of the information we needed about the posterior distribution.</p> <h2 id="why-represent-the-posterior">Why Represent the Posterior?</h2> <p>A natural question at this point is: why do we even need estimates that represent the posterior? Don’t we always have access to the full posterior?</p> <p>This is a valid concern, and if we write down the full posterior (as in the Gaussian cases we considered), we should definitely use all the information we have. But, in many real world cases it is impossible to write down the posterior in closed form, or save the value of the posterior in every place. More concrete examples for this will come in later posts, but let’s consider a simple hypothetical scenario:</p> <blockquote> <p>Suppose we want to classify images, and are using a neural network with thousands, millions, or billions, of parameters $\theta\in\mathbb{R}^p$ to do so. I’ll write down our classifier as the function $f_\theta(x)$ where $x$ is the image. Recall from the <a href="https://friedmanroy.github.io/BML/11_discriminative_classification/">post on discriminative classification</a> that the posterior for a classification problem has no analytical form - we have no formula for the full posterior. Then, to save all information about the posterior would require saving a dense grid of parameter values in a $p$-dimensional space, which is prohibitive beyond 3 dimensions (the number of points on the grid scales exponentially with the dimension). Moreover, calculating the posterior for each parameter choice requires iterating over the whole training set, which can potentially be very large. So each time we want to calculate the value of the posterior, requires a very computationally expensive loop through the whole training set.</p> </blockquote> <p>Scenarios such as the one above are a good indication of the situation we find ourselves in many real scientific settings. To handle the overwhelming scope of the posterior, we might instead towards representing it with a few point estimates as best as we can.</p> <h2 id="multiple-estimates">Multiple Estimates</h2> <p>So, what can we do in such a situation? Instead of describing the full distribution using a single, point estimate, we can save a number of possible parameter choices. Doing so can potentially better represent the full information in the posterior distribution.</p> <p>One option can be to represent the full posterior distribution using each of the local maxima:</p> <div class="fake-img l-page"> <p align="center"> <img src="https://friedmanroy.github.io/assets/bml_figs/rec_14/local_maxima.png" alt="Point estimates under a GMM posterior" style="display: inline-block; margin: 0 auto; "> </p> </div> <div class="caption"> Figure 2: Representing the full posterior using local maxima is a better policy than using the MAP or MMSE estimates. </div> <p>Saving these three points in order to represent the whole distribution makes a lot of sense, especially for GMM posteriors such as these. However, for general distributions it will be quite hard to know how many local maxima there actually are, and finding them will also pose a challenge. Furthermore, there might be situations where the local maxima are still quite bad representatives of the full distribution.</p> <h2 id="sampling-from-the-posterior">Sampling from the Posterior</h2> <p>A way that (I feel) is more natural to represent the posterior is by <em>leveraging the fact that it is a distribution</em>. Instead of trying to optimize a cost function on the density function, we can instead sample from it directly to get our estimates. These samples then serve as “typical” representatives of what we would expect to observe from the posterior, in the sense that regions of higher mass in the distribution will be more populated than those with lower mass.</p> <p>In our recurring sketch of a posterior, sampling would give us the following points:</p> <div class="fake-img l-page"> <p align="center"> <img src="https://friedmanroy.github.io/assets/bml_figs/rec_14/samples.png" alt="Point estimates under a GMM posterior" style="display: inline-block; margin: 0 auto; "> </p> </div> <div class="caption"> Figure 3: Using samples from the posterior in order to represent the whole distribution. </div> <p>Here I used 10 samples, which are depicted by the positions of the gray, dashed lines. Notice how these samples are more less balanced between the two main modes of the distribution, which really describe most of the density function.</p> <p>Now, it might seem that sampling is even harder than the optimization needed to find the modes. But in many situations sampling is quite natural and behaves better than optimization. Indeed, the main focus of the following posts will to introduce methods for easily sampling from the posterior in complex scenarios.</p> <hr> <h1 id="concrete-example-hierarchical-regression">Concrete Example: Hierarchical Regression</h1> <p>Hopefully the sketches above gave a clear indication of the problem with point estimates. In this section, I’d like to consider a very real, practical setting where using either the MAP or MMSE makes no sense. To this end, I’d like to explore <em>hierarchical regression</em>.</p> <p>The setting for hierarchical linear regression is similar to regular linear regression, expect we expect a mixture of different behaviors in the data. We observe data points $\mathcal{D}=\left\{(x_i,y_i)\right\}_{i=1}^N$ which we want to fit using a linear regress, but we assume that each point arose from one out of $K$ different processes, each with their own parameters $\theta_k$ and basis functions $h_k(x)$:</p> \[y_i=\theta_{k_i}^T h_{k_i}(x_i)+\eta_i\qquad \eta_i\sim\mathcal{N}\left(0,\sigma^2\right)\] <p>For example, we might believe that the $y_i$s are linear or quadratic in $x_i$, and we see a mix of the two behaviors. In this case, the regression problem becomes:</p> \[y_i=\begin{cases}\theta_1\cdot x_i\\\text{or}\\\theta_2\cdot x_i^2\end{cases}+\eta_i\] <p>Data in such a scenario will look similar to:</p> <div class="fake-img l-page"> <p align="center"> <img src="https://friedmanroy.github.io/assets/bml_figs/rec_14/sparse_example.png" alt="Example for data in hierarchical regression." style="display: inline-block; margin: 0 auto; "> </p> </div> <div class="caption"> Figure 4: An example of how data in hierarchical regression looks when we don't know the true allocation to basis functions (left) vs. when we do know the allocation (right). </div> <p>So, to solve this regression problem, we would want to know what the true allocation of each data point is to each of the possible basis functions, and the respective parameters for that basis function. Solving this problem is very nontrivial.</p> <h2 id="hierarchical-regression-posterior">Hierarchical Regression Posterior</h2> <p>Concretely, we have a Gaussian prior over the parameters for every behavior:</p> \[\theta_k\sim\mathcal{N}\left(\mu_k,\Sigma_k\right)\] <p>with a-priori probability $\pi_k$ for each behavior.</p> <p>The full posterior is given by:</p> \[\begin{align} p(\theta\vert \mathcal{D})&amp;=\sum_z p(z,\theta\vert \mathcal{D}) \end{align}\] <p>where $z=\left\{k_i\right\}_{i=1}^N$ is the vector of allocations of each datapoint to the respective behavior. So, while it seems simple in this notation, the above sum actually has $K^N$ different terms - each datapoint can be allocated to each of the different behaviors.</p> <p>For a given allocation, the term in the summation is:</p> \[\begin{align} p(\theta\vert \mathcal{D},z) &amp;\propto p(\mathcal{D}\vert \theta,z)\cdot p(\theta\vert z)\\ &amp;= \prod_{i=1}^N\mathcal{N}\left(y_i\vert \ \theta_{k_i}^T h_{k_i}(x_i),\ \sigma^2\right) \cdot \prod_{k=1}^K\mathcal{N}\left(\theta_k\vert \ \ \mu_k,\Sigma_k\right) \end{align}\] <p>This is quite a mess, but for a particular allocation the posterior for each $\theta_k$ can be found simply by considering this as $K$ separate problems.</p> <h2 id="samples-versus-mmse">Samples versus MMSE</h2> <p>In the next post we’ll see how we can sample from the above posterior without explicitly calculating all of it. For now, let’s just look at samples from posterior versus an MMSE estimate:</p> <div class="fake-img l-page"> <p align="center"> <img src="https://friedmanroy.github.io/assets/bml_figs/rec_14/hierarchical_samples.png" alt="Example fits in hierarchical regression" style="display: inline-block; margin: 0 auto; "> </p> </div> <div class="caption"> Figure 5: An example of sampling parameters from the posterior (the 3 plots on the left) versus the MMSE estimate for the parameters (right). Because there are several different modes for both $\theta_1$ and $\theta_2$, the MMSE averages these out and is bad estimate for the true behavior. </div> <p>As you can see, in this scenario we see the concrete results of taking the mean over a posterior with multiple modes as the MMSE estimate, which misses most of the data.</p> <p>This is still quite a simple scenario (and you could “fix” the MMSE in this specific case), but it serves as a very concrete and visual example for the <em>fitting</em> capabilities of sampling from the posterior. Moreover, something we will discuss in the next post is that sampling from this posterior is fairly simple when $K$ is not too large, whereas optimizing the posterior directly would be much more difficult.</p> <hr> <h1 id="discussion">Discussion</h1> <p>Hopefully the examples above provide the conceptual basis for why we would want (multiple) samples in order to describe the full posterior distribution, instead of one specific estimate. In the next few posts will be more mathematically involved, and we will delve into <em>how</em> to sample from the posterior. The examples above, while quite simple, will be our motivation to do so.</p> <hr> <p><span style="float:left"><a href="https://friedmanroy.github.io/BML/13_gmms/">← GMMs and EM</a></span><span style="float:right"><a href=""> →</a></span></p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Roy Friedman. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener noopener noreferrer" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener noopener noreferrer">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-1B05NVC2PJ"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-1B05NVC2PJ");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>