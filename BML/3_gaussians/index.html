<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="fqpmQwGNtZ1kJ8UAsQMb7RD2N7DcYRDlyGbAJsnZuGM"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>The Gaussian Distribution | Roy Friedman</title> <meta name="author" content="Roy Friedman"> <meta name="description" content="The Gaussian distribution is hands-down the most-used distribution in machine learning. This post will go through key aspects of the normal distribution and its representations."> <meta name="keywords" content="academic-website, roy-friedman, machine-learning, ML, bayesian, PhD"> <meta name="google-site-verification" content="EUCyoY6MaSyn4ZvM9TfAuzzeleW7dR0PHS4_UCtyZ4I"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://friedmanroy.github.io/BML/3_gaussians/"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "The Gaussian Distribution",
      "description": "The Gaussian distribution is hands-down the most-used distribution in machine learning. This post will go through key aspects of the normal distribution and its representations.",
      "published": "October 28, 2022",
      "authors": [
        {
          "author": "Roy Friedman",
          "authorURL": "",
          "affiliations": [
            {
              "name": "Hebrew University",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Roy </span>Friedman</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/BML/">Bayesian Machine Learning</a> </li> <li class="nav-item "> <a class="nav-link" href="/_pages/cv/">CV</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>The Gaussian Distribution</h1> <p>The Gaussian distribution is hands-down the most-used distribution in machine learning. This post will go through key aspects of the normal distribution and its representations.</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#definition">Definition</a></div> <div><a href="#geometry-of-the-gaussian-distribution">Geometry of the Gaussian Distribution</a></div> <div><a href="#gaussians-as-log-quadratic-functions">Gaussians as Log-Quadratic Functions</a></div> <ul> <li><a href="#derivatives-of-the-log-pdf">Derivatives of the Log-PDF</a></li> </ul> <div><a href="#conditional-distribution-of-a-gaussian">Conditional Distribution of a Gaussian</a></div> <div><a href="#marginal-distribution-of-a-gaussian">Marginal Distribution of a Gaussian</a></div> <div><a href="#extras">Extras</a></div> <div><a href="#discussion">Discussion</a></div> </nav> </d-contents> <p><span style="float:left"><a href="https://friedmanroy.github.io/BML/2_estimates/">← Estimation and Bayes-Optimal Estimators</a></span><span style="float:right"><a href="https://friedmanroy.github.io/BML/4_gaussian_estimation/">Estimating the Gaussian Distribution →</a></span></p> <p><br> <br></p> <p>The distribution that is used most often in ML (and statistics) is the Gaussian distribution, also called the <em>normal distribution</em>. The reason this distribution is so commonly used is because of two reasons: it is empirically observed in the wild many times and, perhaps more importantly, it is mathematically very simple to use. This post will delve into the definition and properties of the Gaussian distribution<d-footnote>See <a href="https://www.microsoft.com/en-us/research/uploads/prod/2006/01/Bishop-Pattern-Recognition-and-Machine-Learning-2006.pdf" rel="external nofollow noopener noopener noreferrer" target="_blank">Bishop 2.3</a> for a much more extensive introduction to the Gaussian distribution.</d-footnote>.</p> <p><br></p> <h1 id="definition">Definition</h1> <p>A random variable $x$ is said to have a Gaussian distribution if it’s PDF has the following form:</p> <p>\(\begin{equation} p\left(x\right)=\frac{1}{\sqrt{2\pi\sigma^{2}}}\exp\left[-\frac{1}{2\sigma^{2}}\left(x-\mu\right)^{2}\right] \end{equation}\) Notice that this distribution can be completely described by the two parameters $\mu$ and $\sigma$ - the mean and variance of the Gaussian. Because of this, we will usually write:</p> <p>\(\begin{equation} x\sim\mathcal{N}\left(\mu,\sigma^{2}\right) \end{equation}\) to indicate that $x$ is a Gaussian random variable, with the two parameters $\mu$ and $\sigma$ . In the same manner, we denote the PDF by:</p> \[\begin{equation} p\left(x\right)=\mathcal{N}\left(x\,\mid \,\mu,\sigma^{2}\right)\qquad{\scriptstyle \left(\equiv\mathcal{N}\left(x\,;\,\mu,\sigma^{2}\right)\right)} \end{equation}\] <p>The conditioning sign (or semi-colon) in $\mathcal{N}\left(x\,\mid \,\mu,\sigma^{2}\right)$ is to show that $x$ is the variable that we are interested in, while $\mu$ and $\sigma$ are the parameters that define the distribution (so, given a $\mu$ and a $\sigma$, we know the PDF of $x$ ).</p> <p><br></p> <p align="center"> <img src="https://friedmanroy.github.io/assets/bml_figs/rec_1/1D_vis.png" alt="Visualization of a 1D Gaussian" style="display: inline-block; margin: 0 auto; "> </p> <div class="caption"> Figure 1: examples of 1D Gaussian distributions with different means ( $\mu$ ) and standard deviations ( $\sigma$ ). </div> <p><br></p> <p>The multivariate version for a $d$ -dimensional random vector $x\in\mathbb{R}^{d}$ is defined as:</p> \[\begin{equation} \mathcal{N}\left(x\,\mid \,\mu,\Sigma\right)=\frac{1}{\sqrt{\left(2\pi\right)^{d}\mid \Sigma\mid }}\exp\left[-\frac{1}{2}\left(x-\mu\right)^{T}\Sigma^{-1}\left(x-\mu\right)\right] \end{equation}\] <p>and in this case $\mu$ is also a vector and $\Sigma$ is a symmetrical $n\times n$ matrix. The term $D_{M}\left(x\,\mid \,\mu,\Sigma\right)^{2}=\left(x-\mu\right)^{T}\Sigma^{-1}\left(x-\mu\right)$ is often called the <em>Mahalanobis distance</em> and is denoted with $\Delta$. The multivariate version for the Gaussian distribution is also called the <em>multivariate normal</em> (MVN) distribution.</p> <p><br></p> <p align="center"> <img src="https://friedmanroy.github.io/assets/bml_figs/rec_1/2D_vis.png" alt="Visualization of a 2D Gaussian" style="display: inline-block; margin: 0 auto;"> </p> <div class="caption"> Figure 2: example of a 2D Gaussian distribution. On the left is the heatmap of the distribution - darker means higher density. On the right is the contour at $\Delta=1$ overlayed on top of samples from the distribution. The contours of the distribution are ellipses aligned and scaled according to the eigenvectors and eigenvalues of the covariance matrix. </div> <p><br> <br></p> <h1 id="geometry-of-the-gaussian-distribution">Geometry of the Gaussian Distribution</h1> <p>In 1D, the Gaussian distribution takes the form of the famous bell curve in figure 1 and is easy to view. However, in multiple dimensions it is not so clear what the geometry of the distribution actually looks like. We can gain insight by considering the EVD of the covariance matrix $\Sigma$ (remember, this decomposition exists since $\Sigma$ is symmetric):</p> <p>\(\Sigma=UDU^{T}\) where $D$ is a diagonal matrix with the eigenvalues $\lambda_{i}$ on the diagonal and $U$ is an orthonormal matrix (so $UU^{T}=I$ ) with the eigenvectors $u_{i}$ as it’s rows, such that for all $i$ :</p> <p>\(\begin{equation} \Sigma u_{i}=\lambda_{i}u_{i} \end{equation}\) Recall that the eigenvectors are orthogonal to each other, and we can choose eigenvectors that are normalized, so for all $i\neq j$ we have $u_{i}^{T}u_{j}=0$ and $u_{i}^{T}u_{i}=1$ .</p> <p>We can rewrite this decomposition (using the basis defined by the eigenvectors) as:</p> <p>\(\begin{align} \Sigma &amp; =\sum_{i}\lambda_{i}u_{i}u_{i}^{T} \end{align}\) The inverse of this matrix is then given by:</p> <p>\(\begin{equation} \Sigma^{-1}=\sum_{i}\frac{1}{\lambda_{i}}u_{i}u_{i}^{T} \end{equation}\) This allows us to rewrite the Mahalanobis distance as follows:</p> \[\begin{align} \label{eq:gauss-ellipse} \Delta &amp; \equiv D_{M}\left(x\,\mid \,\mu,\Sigma\right)^{2}\\ &amp; =\sum_{i}\frac{1}{\lambda_{i}}\left(x-\mu\right)^{T}u_{i}u_{i}^{T}\left(x-\mu\right)\\ &amp; =\sum_{i}\frac{\left(u_{i}^{T}\left(x-\mu\right)\right)^{2}}{\lambda_{i}}\equiv\sum_{i}\frac{y_{i}^{2}}{\lambda_{i}} \end{align}\] <p>where we defined $y_{i}=u_{i}^{T}\left(x-\mu\right)$ . Notice that the density will be constant on the surfaces where $\Delta$ is constant. The shape described by \eqref{eq:gauss-ellipse} is an <em>ellipse</em> with radii equal to $\lambda_{i}^{1/2}$ , centered around $\mu$ .</p> <p>This is really clear in the 2D case:</p> \[\begin{equation} \Delta=\left(\frac{u_{1}^{T}\left(x-\mu\right)}{\sqrt{\lambda_{1}}}\right)^{2}+\left(\frac{u_{2}^{T}\left(x-\mu\right)}{\sqrt{\lambda_{2}}}\right)^{2} \end{equation}\] <p>So in 2D, all of the <em>contour lines</em> (which are lines that have the same density along the PDF) will always be ellipses; in the multivariate case they will be ellipsoids (which is an ellipse in more dimensions, kind of). Figure 2 (right) shows this explicitly - the Gaussian is centered around the mean $\mu$ , the contour of $\Delta=1$ is an ellipse with axes aligned and scaled by the eigenvectors and square root of the eigenvalues of the covariance matrix.</p> <p><br></p> <h1 id="gaussians-as-log-quadratic-functions">Gaussians as Log-Quadratic Functions</h1> <p>A common approach in many probabilistic modeling methods is to ignore the normalization constant of a distribution, either because it is hard to calculate or because it’s a chore to write it down completely. Moreover, it is sometimes easier to look at distributions in log space. So, for instance, the Gaussian distribution will be written as follows: \(\begin{align} p\left(x\right) &amp; =\underbrace{\frac{1}{Z}}_{\text{normalization}}\cdot\exp\left[-\frac{1}{2}\left(x-\mu\right)^{T}\Sigma^{-1}\left(x-\mu\right)\right]\\ \Leftrightarrow\log p\left(x\right) &amp; =-\frac{1}{2}\left(x-\mu\right)^{T}\Sigma^{-1}\left(x-\mu\right)+\text{const} \end{align}\) where the constant term is only constant with respect to $x$ (not necessarily $\Sigma$ and $\mu$). If we open up the quadratic expression even further, we have: \(\begin{equation} \log p\left(x\right)=-\frac{1}{2}x^{T}\Sigma^{-1}x+x^{T}\Sigma^{-1}\mu+\text{const} \end{equation}\) Again, the constants are only with respect to $x$: $\mu$ is not a function of $x$, so we bunch it together with the constant terms.</p> <p>So, <em>by definition</em>, any distribution that is log-quadratic<d-footnote>Any distribution $p\left(x\right)$ such that $\log p\left(x\right)$ is a quadratic function</d-footnote> is a Gaussian distribution. Being a bit more explicit, whenever we have a distribution of the form: \(\begin{equation} p\left(x\right)\propto\exp\left[-x^{T}\Gamma x+b^{T}x+c\right]\label{eq:log-quad} \end{equation}\) then we know that it will be Gaussian. This is useful knowledge, as Gaussian distributions have nice attributes which can be exploited. Note, however, that in the above example $\Gamma$ and $b$ are <em>not</em> the mean and (inverse) covariance. We will typically need to do a bit more algebra to find the mean and covariance of the distribution, which will allow us to write the Gaussian in “standard form” - as $\mathcal{N}\left(x\ |\ \mu,\Sigma\right)$.</p> <p><br></p> <h2 id="derivatives-of-the-log-pdf">Derivatives of the Log-PDF</h2> <p>As a by-product of the above, the derivatives of the log-PDF of the Gaussian are surprisingly informative and given by: \(\begin{align} \frac{\partial}{\partial x}\log\mathcal{N}\left(x\ |\ \mu,\Sigma\right) &amp; =\frac{\partial}{\partial x}\left[-\frac{1}{2}\left(x-\mu\right)^{T}\Sigma^{-1}\left(x-\mu\right)\right]\\ &amp; =-\Sigma^{-1}\left(x-\mu\right) \end{align}\) This already tells us a lot. For instance, if we want to find the maximum, then we can ensure that the above equals to 0 and we get:</p> \[\begin{equation} -\Sigma^{-1}\left(x-\mu\right)\stackrel{!}{=}0\qquad\Leftrightarrow x=\mu \end{equation}\] <p>since $\Sigma^{-1}\neq0$. So, we always know how to find the mean of the Gaussian distribution! We only have to find the maximum of the log-PDF.</p> <p>Differentiating one more time:</p> \[\begin{align} \frac{\partial^{2}}{\partial x\partial x^{T}}\log\mathcal{N}\left(x\ |\ \mu,\Sigma\right) &amp; =\frac{\partial}{\partial x^{T}}-\Sigma^{-1}\left(x-\mu\right)\\ &amp; =-\Sigma^{-1} \end{align}\] <p>and again we get useful information. Whenever we differentiate twice, we get the precision matrix (a different name for the inverse of the covariance).</p> <p><br></p> <h1 id="conditional-distribution-of-a-gaussian">Conditional Distribution of a Gaussian</h1> <p>An important property of the multivariate Gaussian distribution is that if two sets of variables are jointly Gaussian, then the conditional distribution of one set on the other is also Gaussian.</p> <p>Consider a Gaussian variable separated into 2 parts:</p> \[\begin{equation} x=\left(\begin{matrix}x_{a}\\ x_{b} \end{matrix}\right) \end{equation}\] <p>such that $x\sim\mathcal{N}\left(\mu,\Sigma\right)$ . We can divide the mean and the covariance in a fitting manner:</p> \[\begin{equation} \mu=\left(\begin{matrix}\mu_{a}\\ \mu_{b} \end{matrix}\right),\quad\Sigma=\left(\begin{matrix}\Sigma_{aa} &amp; \Sigma_{ab}\\ \Sigma_{ba} &amp; \Sigma_{bb} \end{matrix}\right) \end{equation}\] <p>Since the covariance is symmetrical, we know that $\Sigma_{ab}=\Sigma_{ba}^{T}$ and that $\Sigma_{aa}$ and $\Sigma_{bb}$ are symmetrical. Actually, it will be easier to use the precision matrix $\Lambda=\Sigma^{-1}$ and divide it up in the same manner:</p> \[\begin{equation} \Lambda=\left(\begin{matrix}\Lambda_{aa} &amp; \Lambda_{ab}\\ \Lambda_{ba} &amp; \Lambda_{bb} \end{matrix}\right) \end{equation}\] <details><summary>Full derivation to find conditional distribution</summary> <p>Note that $\Lambda_{aa}\neq\Sigma_{aa}^{-1}$ ! Later we will find out how each part of $\Lambda$ relates to each part of $\Sigma$ .</p> <p>Let’s start by finding an expression for the conditional distribution $p\left(x_{a}\mid x_{b}\right)$ . We can find this distribution by evaluating the distribution of $p\left(x_{a},x_{b}\right)$ while fixing $x_{b}$ to a certain value and re-normalizing (the conditional distribution is a legal distribution). We will start by rewriting the quadratic term and it’s parts:</p> \[\begin{align} -\frac{1}{2}\left(x-\mu\right)^{T}\Lambda\left(x-\mu\right)=-\frac{1}{2}\left[\left(x_{a}-\mu_{a}\right)^{T}\Lambda_{aa}\left(x_{a}-\mu_{a}\right)\right. &amp; +\left(x_{a}-\mu_{a}\right)^{T}\Lambda_{ab}\left(x_{b}-\mu_{b}\right)\nonumber \\ +\left(x_{b}-\mu_{b}\right)^{T}\Lambda_{ba}\left(x_{a}-\mu_{a}\right) &amp; \left.+\left(x_{b}-\mu_{b}\right)^{T}\Lambda_{bb}\left(x_{b}-\mu_{b}\right)\right] \end{align}\] <p>This is still a quadratic expression w.r.t. $x_{a}$ , so the conditional distribution $p\left(x_{a}\mid x_{b}\right)$ will also be Gaussian. Because the form of the Gaussian is not very flexible, as long as we find what the quadratic term is equal (the one in the exponent), the normalization will work itself out (since the conditional is also a distribution that must integrate up to 1).</p> <p>We can now use the derivative trick! Defining:</p> \[\begin{equation} \Delta=\frac{1}{2}\left(x-\mu\right)^{T}\Sigma^{-1}\left(x-\mu\right) \end{equation}\] <p>Starting with the first derivative:</p> \[\begin{equation}\label{eq:mean-form-1} \frac{\partial\Delta}{\partial x_{a}}=\Lambda_{aa}\left(x_{a}-\mu_{a}\right)+\Lambda_{ab}\left(x_{b}-\mu_{b}\right) \end{equation}\] <p>The second derivative will give us:</p> \[\begin{equation} \begin{split}\frac{\partial^{2}\Delta}{\partial x_{a}\partial x_{a}^{T}} &amp; =\Lambda_{aa}\end{split} \end{equation}\] <p>So we know that the covariance is equal to $\Sigma_{a\mid b}=\Lambda_{aa}^{-1}$ . Using this new found knowledge, we can find the mean, if we can rewrite equation \eqref{eq:mean-form-1} as $\Lambda_{aa}\left(x_{a}-\mu_{a\mid b}\right)$ for some $\mu_{a\mid b}$ . Let’s try to do this. Recall that $\Lambda_{aa}$ is invertible, so we can write:</p> \[\begin{align} \Lambda_{aa}\left(x_{a}-\mu_{a}\right)+\Lambda_{ab}\left(x_{b}-\mu_{b}\right) &amp; =\Lambda_{aa}\left(x_{a}-\mu_{a}+\Lambda_{aa}^{-1}\Lambda_{ab}\left(x_{b}-\mu_{b}\right)\right)\nonumber \\ &amp; =\Lambda_{aa}\left[x_{a}-\left(\mu_{a}-\Lambda_{aa}^{-1}\Lambda_{ab}\left(x_{b}-\mu_{b}\right)\right)\right]\nonumber \\ &amp; \stackrel{\Delta}{=}\Lambda_{aa}\left(x_{a}-\mu_{a\mid b}\right) \end{align}\] <p>Which means that the conditional distribution is parameterized by:</p> \[\begin{align} \mu_{a\mid b} &amp; =\mu_{a}-\Lambda_{aa}^{-1}\Lambda_{ab}\left(x_{b}-\mu_{b}\right)\\ \Sigma_{a\mid b} &amp; =\Lambda_{aa}^{-1} \end{align}\] <p>Okay, now all that remains is to find what $\Lambda_{aa}$ and $\Lambda_{ab}$ are equal to in terms of $\Sigma$ . To do this, we will use the following identity for partitioned matrices:</p> \[\begin{equation} \left(\begin{array}{cc} A &amp; B\\ C &amp; D \end{array}\right)^{-1}=\left(\begin{array}{cc} M &amp; -MBD^{-1}\\ -D^{-1}CM &amp; \quad D^{-1}+D^{-1}CMBD^{-1} \end{array}\right)^{-1} \end{equation}\] <p>where $M=\left(A-BD^{-1}C\right)^{-1}$ is called the <em>Schur component</em> of the matrix with respect to the sub-matrix $D$ . Using our earlier partitioning, we get:</p> \[\begin{align} \Lambda_{aa} &amp; =\left(\Sigma_{aa}-\Sigma_{ab}\Sigma_{bb}^{-1}\Sigma_{ba}\right)^{-1}\\ \Lambda_{ab} &amp; =-\Lambda_{aa}\Sigma_{ab}\Sigma_{bb}^{-1} \end{align}\] </details> <p>The conditional distribution in such a setting is given by:</p> \[\begin{align} p\left(x_{a}\mid x_{b}\right) &amp; =\mathcal{N}\left(x_{a}\,\mid \,\mu_{a\mid b},\Sigma_{a\mid b}\right)\\ \mu_{a\mid b} &amp; =\mu_{a}+\Sigma_{ab}\Sigma_{bb}^{-1}\left(x_{b}-\mu_{b}\right)\nonumber \\ \Sigma_{a\mid b} &amp; =\Sigma_{aa}-\Sigma_{ab}\Sigma_{bb}^{-1}\Sigma_{ba}\nonumber \end{align}\] <p>Note that in this case, the conditional distribution is much easier to describe in terms of the precision matrix instead of the covariance matrix:</p> \[\begin{align} \mu_{a\mid b} &amp; =\mu_{a}-\Lambda_{aa}^{-1}\Lambda_{ab}\left(x_{b}-\mu_{b}\right)\\ \Sigma_{a\mid b} &amp; =\Lambda_{aa}^{-1} \end{align}\] <p>When implementing the code for this, it may be simpler to save the precision matrix (as well as the covariance matrix) in memory to easily compute the conditional distribution.</p> <p align="center"> <img src="https://friedmanroy.github.io/assets/bml_figs/rec_1/cond_vis.png" alt="Visualization of a 1D Gaussian" style="display: inline-block; margin: 0 auto; "> </p> <div class="caption"> Figure 3: visualization of the conditional of a bivariate Gaussian; plots of $p\left(x_{a}\mid x_{b}\right)$ for various values of $x_{b}$ . Notice how the variance doesn't change for different values of $x_{b}$ , only the mean of the conditional. </div> <p><br></p> <h1 id="marginal-distribution-of-a-gaussian">Marginal Distribution of a Gaussian</h1> <p>Another important property of the Gaussian distribution is that its marginals are also Gaussian, which is what we will show here.</p> <p>Again, we consider a Gaussian variable separated into 2 parts:</p> \[\left(\begin{matrix}x_{a}\\ x_{b} \end{matrix}\right)\sim\mathcal{N}\left(\left(\begin{matrix}\mu_{a}\\ \mu_{b} \end{matrix}\right),\left(\begin{matrix}\Sigma_{aa} &amp; \Sigma_{ab}\\ \Sigma_{ba} &amp; \Sigma_{bb} \end{matrix}\right)\right)\] <p>and we will again define $\Lambda=\Sigma^{-1}$ . We want to find $p\left(x_{a}\right)$ .</p> <details><summary>Click here to see the derivation</summary> <p>Our battle plan is to first find all of the dependence on $x_{b}$ , and to integrate it out. If we can do this without losing track of $x_{a}$ , we will be able to find the marginal distribution and win. Notice that the Mahalanobis distance is quadratic in $x_{b}$ (as usual), so the final form we will get to will be something like:</p> \[p\left(x_{a}\right)=f\left(x_{a}\right)\intop\mathcal{N}\left(x_{b}\,\mid \,\mu_{x_{b}},\Sigma_{x_{b}}\right)dx_{b}=f\left(x_{a}\right)\] <p>So, let’s try to open up the Mahalanobis distance (the part in the exponent) and separate it into two groups: terms that contain $x_{b}$ and those that don’t.</p> <p>We begin by defining $y=x-\mu$ , which in this case will allow us to write the Mahalanobis distance as:</p> \[\begin{align} \Delta &amp; =\frac{1}{2}\left(\begin{matrix}y_{a}\\ y_{b} \end{matrix}\right)^{T}\left(\begin{matrix}\Lambda_{a} &amp; B\\ B^{T} &amp; \Lambda_{b} \end{matrix}\right)\left(\begin{matrix}y_{a}\\ y_{b} \end{matrix}\right)\nonumber \\ &amp; =\frac{1}{2}\left(\begin{matrix}y_{a}\\ y_{b} \end{matrix}\right)^{T}\left(\begin{matrix}\Lambda_{a}y_{a}+By_{b}\\ B^{T}y_{a}+\Lambda_{b}y_{b} \end{matrix}\right)\nonumber \\ &amp; =\frac{1}{2}y_{a}^{T}\Lambda_{a}y_{a}+\underbrace{\frac{1}{2}\left[2y_{b}^{T}By_{a}+y_{b}^{T}\Lambda_{b}y_{b}\right]}_{\left(*\right)} \end{align}\] <p>Note that if we find the marginal of $y_{a}$ , we effectively find the marginal of $x_{a}$ , only we don’t have to keep track of $\mu_{a}$ and $\mu_{b}$ ! We now need to complete the squares in $\left(*\right)$ to find the complete dependence on $y_{b}$ :</p> \[\begin{align} 2y_{b}^{T}By_{a}+y_{b}^{T}\Lambda_{b}y_{b} &amp; =y_{b}^{T}\Lambda_{b}y_{b}+2y_{b}^{T}By_{a}\nonumber \\ &amp; =y_{b}^{T}\Lambda_{b}y_{b}+2y_{b}^{T}\Lambda_{b}\Lambda_{b}^{-1}By_{a}\nonumber \\ &amp; =y_{b}^{T}\Lambda_{b}y_{b}+2y_{b}^{T}\Lambda_{b}\Lambda_{b}^{-1}By_{a}+y_{a}^{T}B^{T}\Lambda_{b}^{-1}\Lambda_{b}\Lambda_{b}^{-1}By_{a}-y_{a}^{T}B^{T}\Lambda_{b}^{-1}\Lambda_{b}\Lambda_{b}^{-1}By_{a}\nonumber \\ &amp; =\left(y_{b}+\Lambda_{b}^{-1}By_{a}\right)^{T}\Lambda_{b}\left(y_{b}+\Lambda_{b}^{-1}By_{a}\right)-y_{a}^{T}B^{T}\Lambda_{b}^{-1}By_{a} \end{align}\] <p>We add this back to the full Mahalanobis distance to get:</p> \[\begin{equation} \Delta=\frac{1}{2}y_{a}^{T}\left(\Lambda_{a}-B^{T}\Lambda_{b}^{-1}B\right)y_{a}+\frac{1}{2}\left(y_{b}+\Lambda_{b}^{-1}By_{a}\right)^{T}\Lambda_{b}\left(y_{b}+\Lambda_{b}^{-1}By_{a}\right) \end{equation}\] <p>So our distribution is:</p> \[\begin{align} p\left(y_{a}\right) &amp; \propto\exp\left[-\frac{1}{2}y_{a}^{T}\left(\Lambda_{a}-B^{T}\Lambda_{b}^{-1}B\right)y_{a}\right]\intop\exp\left[-\frac{1}{2}\left(y_{b}+\Lambda_{b}^{-1}By_{a}\right)^{T}\Lambda_{b}\left(y_{b}+\Lambda_{b}^{-1}By_{a}\right)\right]dy_{b}\nonumber \\ &amp; \propto\exp\left[-\frac{1}{2}y_{a}^{T}\left(\Lambda_{a}-B^{T}\Lambda_{b}^{-1}B\right)y_{a}\right] \end{align}\] <p>which is definitely Gaussian! We were allowed to do the second move because the integral will be the normalization term of the Gaussian, which is a function of $\Lambda_{b}$ - which is constant with respect to $y_{a}$ (and so is eaten up by the $\propto$ sign).</p> <p>Finally, we see that:</p> \[\begin{equation} y_{a}\sim\mathcal{N}\left(0,\left(\Lambda_{a}-B^{T}\Lambda_{b}^{-1}B\right)^{-1}\right)\Rightarrow x_{a}\sim\mathcal{N}\left(\mu_{a},\left(\Lambda_{a}-B^{T}\Lambda_{b}^{-1}B\right)^{-1}\right) \end{equation}\] <p>and all that remains is to find what the covariance is equal to in terms of $\Sigma$ . To do this, we use the same identity we saw in the previous example:</p> \[\begin{equation} \Sigma_{aa}=\left(\Lambda_{aa}-B^{T}\Lambda_{b}^{-1}B\right)^{-1} \end{equation}\] <p>So, the marginal is:</p> \[\begin{equation} x_{a}\sim\mathcal{N}\left(\mu_{a},\Sigma_{aa}\right) \end{equation}\] <p>which really makes you wonder why we did all of that hard work.</p> </details> <p>The marginals of the Gaussian distribution are much more intuitive than their conditional distributions. The marginals are given by:</p> \[\begin{equation} x_{a}\sim\mathcal{N}\left(\mu_{a},\Sigma_{aa}\right) \end{equation}\] <p><br></p> <h1 id="extras">Extras</h1> <p>We saw the so called “derivative trick” and how completing the squares can also be of help, but it might not be obvious when to use each approach. First, remember that whenever we see a distribution of the form:</p> \[\begin{equation} p\left(x,y\right)\propto\exp\left[-x^{T}\Gamma x+b\left(y\right)^{T}x+g\left(y\right)\right] \end{equation}\] <p>then $p\left(x\right)$ and $p\left(x\mid y\right)$ will be Gaussians<d-footnote>This is a slightly more general statement than what we showed here, but you can verify the validity for yourself in these cases as well.</d-footnote>, and we will usually want to find the “Gaussian form” we know and love. Once we figured that out, we can try to ask “how can we find the Gaussian form?”, and the answer will usually be one of the following methods:</p> <ul> <li>If we don’t care about $p\left(y\right)$ or $p\left(y\mid x\right)$ at all, i.e. we want to specifically find $p\left(x\right)$ or $p\left(x\mid y\right)$ , then we can use the derivative trick</li> <li>If we need to know $p\left(y\right)$ or $p\left(y\mid x\right)$ explicitly as well as $p\left(x\right)$ or $p\left(x\mid y\right)$ , then completing the squares is usually the easiest way</li> <li>When all else fails, but we know that what we are looking for is Gaussian, we can calculate the expectations and covariance explicitly, since a Gaussian is completely defined by these two values</li> </ul> <p>Once you fully understand why each method works, it will become quite clear when you should use each of them.</p> <p><br></p> <h1 id="discussion">Discussion</h1> <p>Now that we know what the Gaussian distribution is and the important properties of the Gaussian distribution, we can start to use in for some real statistical problems. The next post will be dedicated to estimating $\mu$ and $\Sigma$ from observed data, after which we will move on to utilizing the Gaussian distribution in the task of regression. <br></p> <hr> <p><span style="float:left"><a href="https://friedmanroy.github.io/BML/2_estimates/">← Estimation and Bayes-Optimal Estimators</a></span><span style="float:right"><a href="https://friedmanroy.github.io/BML/4_gaussian_estimation/">Estimating the Gaussian Distribution →</a></span></p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Roy Friedman. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener noopener noreferrer" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener noopener noreferrer">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-1B05NVC2PJ"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-1B05NVC2PJ");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>